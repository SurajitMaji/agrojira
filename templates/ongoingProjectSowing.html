{% extends 'ongoingProjectBase.html'%}
{% load static %}

{% block title %}
{{ project.crop_name }} Sowing Stage
{% endblock title %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'css/completedProject.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/ongoingProjectSoil.css' %}">
{% endblock head %}

{% block projectDetailsBody %}
<div class="project-datails-container">
  
  {% if not sowings %}
  <div class="each-soil-form">
    <div class="header">Sowing Details Form</div>
    <form method="POST" action="/submit_farmerSowing" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="section">
        <div class="label">Seed Variety:</div>
        <div class="value"><input type="text" name="seed_variety" required></div>
      </div>
      <div class="section foreign_key">
        <div class="label">Project Id:</div>
        <div class="value"><input type="number" name="project_id" readonly value="{{ project.project_id }}"></div>
      </div>
      <div class="section">
        <div class="label">Seed Treatment:</div>
        <div class="value"><textarea name="seed_treatment"></textarea></div>
      </div>
      <div class="section">
        <div class="label">Sowing Time:</div>
        <div class="value"><input type="text" name="sowing_time" required></div>
      </div>
      <div class="section">
        <div class="label">Seed Rate (kg/acre):</div>
        <div class="value"><input type="number" step="0.01" name="seed_rate" required></div>
      </div>
      <div class="section">
        <div class="label">Sowing Method:</div>
        <div class="value"><input type="text" name="sowing_method" required></div>
      </div>
      <div class="section">
        <div class="label">Row Spacing:</div>
        <div class="value"><input type="text" name="row_spacing" required></div>
      </div>
      <div class="section">
        <div class="label">Sowing Depth:</div>
        <div class="value"><input type="text" name="sowing_depth" required></div>
      </div>
      <div class="section">
        <div class="label">Equipment Used:</div>
        <div class="value"><textarea name="equipment_used"></textarea></div>
      </div>
      <div class="section">
        <div class="label">Sowing Image:</div>
        <div class="value">
          <input type="file" name="sowing_image" required onchange="preview(this,'photo_preview')">
          <img alt="Sowing Image" id="photo_preview">
        </div>
      </div>
      <div class="buttons">
        <button type="submit" class="edit-btn">Submit</button>
      </div>
    </form>
  </div>
  
  {% else %}
  {% for sowing in sowings %}
  <div class="each-soil-recorder">
    <div class="header">Sowing Report No: {{ forloop.counter }}</div>
    <div class="section"><div class="label">Seed Variety:</div><div class="value">{{ sowing.seed_variety }}</div></div>
    <div class="section"><div class="label">Seed Treatment:</div><div class="value">{{ sowing.seed_treatment }}</div></div>
    <div class="section"><div class="label">Sowing Time:</div><div class="value">{{ sowing.sowing_time }}</div></div>
    <div class="section"><div class="label">Seed Rate:</div><div class="value">{{ sowing.seed_rate }}</div></div>
    <div class="section"><div class="label">Sowing Method:</div><div class="value">{{ sowing.sowing_method }}</div></div>
    <div class="section"><div class="label">Row Spacing:</div><div class="value">{{ sowing.row_spacing }}</div></div>
    <div class="section"><div class="label">Sowing Depth:</div><div class="value">{{ sowing.sowing_depth }}</div></div>
    <div class="section"><div class="label">Equipment Used:</div><div class="value">{{ sowing.equipment_used }}</div></div>
    {% if sowing.expert_advise %}
    <div class="section"><div class="label">Expert Advise:</div><div class="value">{{ sowing.expert_advise }}</div></div>
    {% endif %}
    <div class="section"><div class="label">Is Completed:</div><div class="value">{{ sowing.is_completed }}</div></div>
    <div class="section"><div class="label">Created At:</div><div class="value">{{ sowing.created_at }}</div></div>
    <div class="section"><div class="label">Updated At:</div><div class="value">{{ sowing.updated_at }}</div></div>
    <div class="section"><div class="label">ML Prediction:</div><div class="value">{{ sowing.ml_prediction }}</div></div>
    <div class="section"><div class="label">ML Confidence:</div><div class="value">{{ sowing.ml_confidence }}</div></div>
    <div class="section">
      <div class="label">Sowing Image:</div>
      <div class="value"><img src="{{ sowing.sowing_image.url }}" alt="Sowing Image"></div>
    </div>
    <div class="buttons">
      {% comment %} <a href="{% url 'ongoingProjectSowingUpdate' project.project_id sowing.farmer_sowing_id %}">
        <button class="edit-btn">Edit</button>
      </a>
      <button class="delete-btn" onclick="deleteReport()">Delete</button> {% endcomment %}
    </div>
  </div>
  {% endfor %}
  {% endif %}
</div>

<script>
  function deleteReport() {
    if (confirm("Are you sure you want to delete this report?")) {
      alert("Delete functionality goes here.");
    }
  }
</script>
{% endblock projectDetailsBody %}

{% block javaScript %}
<script src="{% static 'js/imagePreview.js' %}"></script>
{% endblock javaScript %}
